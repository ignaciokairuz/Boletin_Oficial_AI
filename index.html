<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor de Gastos P√∫blicos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg-primary: #1a1a2e; --bg-secondary: #16213e; --bg-tertiary: #0f3460; --text-primary: #eee; --text-secondary: #aaa; --accent: #e94560; --accent-hover: #ff6b6b; --success: #4ecca3; --warning: #ffc107; }
        body.light-mode { --bg-primary: #f5f5f5; --bg-secondary: #fff; --bg-tertiary: #e0e0e0; --text-primary: #333; --text-secondary: #666; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); transition: all 0.3s; }
        .container { display: flex; min-height: 100vh; }
        .sidebar { width: 280px; background: var(--bg-secondary); padding: 20px; border-right: 1px solid var(--bg-tertiary); position: fixed; height: 100vh; overflow-y: auto; transition: transform 0.3s; }
        .sidebar.collapsed { transform: translateX(-280px); }
        .sidebar h2 { color: var(--accent); margin-bottom: 20px; }
        .sidebar-section { margin-bottom: 25px; }
        .sidebar-section h3 { color: var(--text-secondary); font-size: 0.8em; text-transform: uppercase; margin-bottom: 10px; }
        .date-list, .tab-list { list-style: none; }
        .date-list li, .tab-list li { padding: 8px 12px; cursor: pointer; border-radius: 6px; margin-bottom: 4px; }
        .date-list li:hover, .tab-list li:hover { background: var(--bg-tertiary); }
        .date-list li.active { background: var(--accent); color: white; }
        .tab-list li.active { background: var(--bg-tertiary); border-left: 3px solid var(--accent); }
        .theme-toggle { display: flex; align-items: center; gap: 10px; padding: 10px; background: var(--bg-tertiary); border-radius: 8px; cursor: pointer; margin-top: 15px; }
        .theme-toggle-switch { width: 40px; height: 22px; background: #555; border-radius: 11px; position: relative; }
        .theme-toggle-switch::after { content: ''; position: absolute; width: 18px; height: 18px; background: white; border-radius: 50%; top: 2px; left: 2px; transition: 0.3s; }
        body.light-mode .theme-toggle-switch { background: var(--accent); }
        body.light-mode .theme-toggle-switch::after { transform: translateX(18px); }
        .toggle-btn { position: fixed; left: 280px; top: 20px; background: var(--accent); border: none; color: white; padding: 10px; border-radius: 0 6px 6px 0; cursor: pointer; z-index: 100; transition: left 0.3s; }
        .toggle-btn.collapsed { left: 0; }
        .main { margin-left: 280px; flex: 1; padding: 30px; transition: margin-left 0.3s; }
        .main.expanded { margin-left: 0; }
        .header { background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary)); padding: 25px; border-radius: 12px; margin-bottom: 25px; }
        .header h1 { font-size: 1.8em; margin-bottom: 8px; }
        .header-controls { display: flex; gap: 15px; align-items: center; margin-top: 15px; flex-wrap: wrap; }
        .filter-select { padding: 8px 12px; border-radius: 6px; border: 1px solid var(--bg-tertiary); background: var(--bg-secondary); color: var(--text-primary); min-width: 200px; }
        .stats { display: flex; gap: 15px; flex-wrap: wrap; }
        .stat { background: rgba(233,69,96,0.2); padding: 10px 15px; border-radius: 8px; }
        .stat-value { font-size: 1.3em; font-weight: bold; color: var(--accent); }
        .stat-label { font-size: 0.75em; color: var(--text-secondary); }
        .card-grid { display: grid; gap: 15px; }
        .card { background: var(--bg-secondary); padding: 20px; border-radius: 10px; border-left: 4px solid var(--bg-tertiary); transition: all 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .card.expensive { border-left-color: var(--accent); }
        .card .amount { font-size: 1.3em; font-weight: bold; color: var(--success); margin-bottom: 8px; }
        .card.expensive .amount { color: var(--accent); }
        .card .desc { color: var(--text-secondary); line-height: 1.5; margin-bottom: 10px; }
        .card .desc-long { display: none; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--bg-tertiary); }
        .card.expanded .desc-long { display: block; }
        .card .meta { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .tag { background: var(--bg-tertiary); padding: 4px 10px; border-radius: 4px; font-size: 0.8em; }
        .btn { background: var(--accent); color: white; padding: 6px 12px; border-radius: 4px; text-decoration: none; font-size: 0.85em; cursor: pointer; border: none; }
        .btn:hover { background: var(--accent-hover); }
        .btn.secondary { background: var(--bg-tertiary); color: var(--text-primary); }
        .anexos-list { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--bg-tertiary); }
        .anexo-link { display: inline-block; margin: 2px; padding: 4px 8px; background: var(--bg-tertiary); border-radius: 4px; font-size: 0.75em; color: var(--text-secondary); text-decoration: none; cursor: pointer; }
        .anexo-link:hover { background: var(--accent); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .chart-container { background: var(--bg-secondary); padding: 20px; border-radius: 12px; }
        .chart-toggle { display: flex; gap: 10px; margin-bottom: 15px; }
        .chart-toggle button { padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer; background: var(--bg-tertiary); color: var(--text-primary); }
        .chart-toggle button.active { background: var(--accent); color: white; }
        .footer { text-align: center; padding: 30px; color: var(--text-secondary); }
        .footer a { color: var(--accent); }
    </style>
</head>
<body>
    <button class="toggle-btn" onclick="toggleSidebar()">‚ò∞</button>
    <div class="container">
        <aside class="sidebar" id="sidebar">
            <h2>üîç Monitor</h2>
            <div class="sidebar-section">
                <h3>üìÖ Fecha</h3>
                <ul class="date-list" id="dateList">
                    <li class="active" onclick="loadDate('2026-01-21')">21/01/2026</li>
                </ul>
            </div>
            <div class="sidebar-section">
                <h3>üìã Vista</h3>
                <ul class="tab-list">
                    <li class="active" onclick="showTab('gastos')">üí∞ Gastos</li>
                    <li onclick="showTab('licitaciones')">üèõÔ∏è Licitaciones (0)</li>
                    <li onclick="showTab('otros')">üìÑ Otras Normas</li>
                    <li onclick="showTab('anexos')">üìé Anexos</li>
                    <li onclick="showTab('stats')">üìä Estad√≠sticas</li>
                </ul>
            </div>
            <div class="theme-toggle" onclick="toggleTheme()">
                <span>üåô</span><div class="theme-toggle-switch"></div><span>‚òÄÔ∏è</span>
            </div>
        </aside>
        <main class="main" id="main">
            <div class="header">
                <h1>Bolet√≠n N¬∞ <span id="numBoletin">7288</span></h1>
                <p>Fecha: <span id="fechaDisplay">21/01/2026</span></p>
                <div class="header-controls">
                    <select class="filter-select" id="filterOrganismo" onchange="filterByOrganismo()">
                        <option value="">üèõÔ∏è Todos los organismos</option>
                    </select>
                    <div class="stats">
                        <div class="stat"><div class="stat-value" id="statGastos">0</div><div class="stat-label">Gastos</div></div>
                        <div class="stat"><div class="stat-value" id="statLic">0</div><div class="stat-label">Licitaciones</div></div>
                        <div class="stat"><div class="stat-value" id="statAnexos">0</div><div class="stat-label">Anexos</div></div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content active" id="tab-gastos">
                <div class="card-grid" id="gastosGrid">
                </div>
            </div>
            
            <div class="tab-content" id="tab-licitaciones">
                <div class="card-grid" id="licitacionesGrid">
                </div>
            </div>
            
            <div class="tab-content" id="tab-otros">
                <div class="card-grid" id="otrosGrid">
                </div>
            </div>
            
            <div class="tab-content" id="tab-anexos">
                <div class="card-grid" id="anexosGrid">
                </div>
            </div>
            
            <div class="tab-content" id="tab-stats">
                <div class="chart-container">
                    <div class="chart-toggle">
                        <button class="active" onclick="updateChart('count')">üìä Cantidad</button>
                        <button onclick="updateChart('amount')">üí∞ Monto</button>
                    </div>
                    <canvas id="statsChart" height="400"></canvas>
                </div>
            </div>
            
            <div class="footer">
                <a href="https://github.com/ignaciokairuz/Boletin_Oficial_AI">Boletin_Oficial_AI</a>
            </div>
        </main>
    </div>
    
    <script>
        const allData = {"2026-01-21": {"fecha": "2026-01-21", "fecha_display": "21/01/2026", "numero_boletin": 7288, "total_normas": 0, "total_anexos": 0, "organismos": [], "gastos": [], "sin_gastos": [], "licitaciones": [], "errores": 0}};
        let currentChart = null, chartMode = 'count';
        
        function toggleTheme() { document.body.classList.toggle('light-mode'); localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark'); }
        if (localStorage.getItem('theme') === 'light') document.body.classList.add('light-mode');
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
            document.getElementById('main').classList.toggle('expanded');
            document.querySelector('.toggle-btn').classList.toggle('collapsed');
        }
        
        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-list li').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');
            event.target.classList.add('active');
            if (tab === 'stats') initChart();
        }
        
        function goToAnexo(id) {
            showTab('anexos');
            document.querySelectorAll('.tab-list li')[3].classList.add('active');
            setTimeout(() => { const el = document.getElementById('anexo_' + id); if (el) el.scrollIntoView({ behavior: 'smooth' }); }, 100);
        }
        
        function filterByOrganismo() {
            const f = document.getElementById('filterOrganismo').value.toLowerCase();
            document.querySelectorAll('.card').forEach(c => { c.style.display = (!f || (c.dataset.organismo || '').toLowerCase().includes(f)) ? 'block' : 'none'; });
        }
        
        function loadDate(date) {
            const d = allData[date]; if (!d) return;
            document.getElementById('numBoletin').textContent = d.numero_boletin;
            document.getElementById('fechaDisplay').textContent = d.fecha_display;
            document.getElementById('statGastos').textContent = d.gastos.length;
            document.getElementById('statLic').textContent = (d.licitaciones || []).length;
            document.querySelectorAll('.date-list li').forEach(li => li.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        function initChart() {
            const ctx = document.getElementById('statsChart').getContext('2d');
            const dates = Object.keys(allData).sort();
            const orgs = new Set();
            dates.forEach(d => allData[d].gastos.forEach(g => orgs.add(g.organismo || 'Otros')));
            const orgList = Array.from(orgs).slice(0, 8);
            const colors = ['#e94560','#4ecca3','#ffc107','#00bcd4','#9c27b0','#ff5722','#2196f3','#8bc34a'];
            const datasets = orgList.map((org, i) => ({
                label: org.substring(0, 20),
                data: dates.map(d => {
                    const g = allData[d].gastos.filter(x => x.organismo === org);
                    return chartMode === 'count' ? g.length : g.reduce((s, x) => s + (x.monto || 0), 0);
                }),
                backgroundColor: colors[i]
            }));
            if (currentChart) currentChart.destroy();
            currentChart = new Chart(ctx, { type: 'bar', data: { labels: dates, datasets }, options: { responsive: true, scales: { x: { stacked: true }, y: { stacked: true } } } });
        }
        
        function updateChart(mode) {
            chartMode = mode;
            document.querySelectorAll('.chart-toggle button').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            initChart();
        }
    </script>
</body>
</html>